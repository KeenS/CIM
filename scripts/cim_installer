#!/bin/sh
set -e
: ${CIM_HOME:=$HOME/.cim};
export CIM_HOME;
mkdir -p $CIM_HOME/archives;
mkdir -p $CIM_HOME/tmp;
curl -L https://codeload.github.com/KeenS/CIM/tar.gz/master | gzip -cd - | tar xf - -C $CIM_HOME/tmp;
mv $CIM_HOME/tmp/CIM-master/* $CIM_HOME/;
for dir in archives bin cores impls lib quicklisp res scripts src sysets tmp
do
    mkdir -p $CIM_HOME/$dir
done;
ln -s $CIM_HOME/scripts/cl $CIM_HOME/bin/cl;
cat <<EOF > $CIM_HOME/scripts/cim_init;
#!/bin/sh
: \${CIM_HOME:=$CIM_HOME};
export CIM_HOME
. \$CIM_HOME/scripts/cim_env
. \$cim_scripts_path/cim_default
export PATH=\$cim_bin_path:\$PATH

. \$cim_scripts_path/cim

EOF
echo <<EOM;
Add to your .*rc file
'[ -s $HOME/.cim/scripts/cim_init ] && . $HOME/.cim/scripts/cim_init'
.
EOM
. $CIM_HOME/scripts/cim_init;
